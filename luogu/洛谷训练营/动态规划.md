## luogu

### [é€’å½’è¡¥é¢˜](https://www.luogu.com.cn/problem/P1010#submit)

### çº¿æ€§åŠ¨æ€è§„åˆ’

#### P1439

æœ€é•¿å…¬å…±å­åºåˆ—â€œæ¨¡æ¿é¢˜â€ï¼ˆä¸æ˜¯ğŸ¤”

å½“æ•°æ®èŒƒå›´ä¸º $10^3$ æ—¶ï¼Œå¯ä»¥ç”¨ $O(N^2)$ çš„åšæ³•ï¼Œå¼€ $O(N^2)$ çš„è¾…åŠ©ç©ºé—´ï¼Œä»£ç å¦‚ä¸‹ï¼š

``` c++
#include <iostream>
#include <cstring>
#include <algorithm>

using namespace std;

const int N = 3010;

int n;
int a[N], b[N];
int f[N][N];
// f[i][j] è¡¨ç¤ºä»¥ b[j]ç»“å°¾çš„æœ€é•¿å…¬å…±å­åºåˆ—

int main()
{
    cin >> n;
    for(int i = 1; i <= n; i ++ )   cin >> a[i];
    for(int i = 1; i <= n; i ++ )   cin >> b[i];
    
    int res = 0;
    for(int i = 1; i <= n; i ++ )
    {
        int maxn = 1;   // è‡³å°‘ä¸º1ï¼Œå› ä¸ºç”¨åˆ°å®ƒæ—¶è‚¯å®šæœ‰a[i]==b[j] 
        for(int j = 1; j <= n; j ++ )
        {
            // 1. ä¸é€‰ a[i]
            f[i][j] = f[i - 1][j];
            // 2. é€‰ a[i]ï¼Œåˆ™ a[i] å¿…é¡»è¦ç­‰äº b[j]
            if(a[i] == b[j])
            {
                // f[i][j] = max(f[i][j], 1);  
                // for(int k = 1; k < j; k ++ )
                //     if(a[i] > b[k])
                //         f[i][j] = max(f[i - 1][k] + 1, f[i][j]);
                f[i][j] = max(f[i][j], maxn);
            }
            // åŠ¨æ€ç»´æŠ¤
            if(a[i] > b[j]) maxn = max(maxn, f[i - 1][j] + 1);
            res = max(res, f[i][j]);
        }
    }
    cout << res << endl;
    return 0;
}
/*
10
1 5 3 6 3 2 7 3 6 2 
9 6 2 3 1 5 3 3 6 1
expect:2
*/
```

ä½†æ˜¯æœ¬é¢˜çš„æ•°æ®èŒƒå›´ä¸º $10^5$ï¼Œæ— è®ºæ—¶é—´è¿˜æ˜¯ç©ºé—´éƒ½ä¸èƒ½æ¥å— $O(N^2)$ çš„çº§åˆ«ã€‚

æˆ‘ä»¬ä¹‹å‰å·²ç»åšè¿‡äºŒåˆ†ç‰ˆæœ¬çš„æœ€é•¿ä¸Šå‡å­åºåˆ—(LIS)ï¼Œé‚£ä¹ˆæ˜¯å¦ LCS ä¹Ÿå¯ä»¥äºŒåˆ†å‘¢ï¼Ÿç­”æ¡ˆæ˜¯å¯ä»¥çš„ï¼ç”šè‡³ï¼ŒLCS ç›´æ¥æŠŠ LIS çš„æ€æƒ³â€œå·â€è¿‡æ¥äº†ã€‚ä¸‹é¢çœ‹çœ‹ LCS æ˜¯æ€ä¹ˆå·çš„ã€‚

å¯¹äºæ ·ä¾‹ï¼š

``` c++
3 2 1 4 5
1 2 3 4 5
```

å¯¹äºåºåˆ— Aï¼Œæˆ‘ä»¬è®© 3->a,2->b,1->c,â€¦..ä»¥æ­¤ç±»æ¨

åˆ™ï¼Œè½¬åŒ–ä¸ºï¼š

``` c++
a b c d e
c b a d e
```

æ­¤æ—¶ï¼Œåºåˆ— B çš„ LIS å°±æ˜¯ A å’Œ B çš„ LCSã€‚

å› ä¸ºï¼Œæˆ‘ä»¬æŠŠåºåˆ— A ç¦»æ•£ä¸ºï¼ˆä¹Ÿå¯ä»¥è¯´æ˜ å°„ä¸ºï¼‰ä¸€ä¸ª**â€œé¡ºåºâ€**é€’å¢çš„åºåˆ—ï¼ŒåŒæ—¶ä¹ŸæŠŠè¿™ç§ç¦»æ•£ä½œç”¨åˆ° B èº«ä¸Šã€‚

é‚£ä¹ˆæ­¤æ—¶ B çš„é€’å¢å­åºåˆ—ä¸€å®šå°±æ˜¯ A çš„æŸä¸ªé€’å¢å­åºåˆ—ï¼Œå› ä¸º A æ˜¯è¿ç»­é€’å¢çš„ï¼Œå®ƒåŒ…å«äº†æ‰€æœ‰é€’å¢çš„æƒ…å†µã€‚

ä¹Ÿå³ï¼ŒB çš„ä¸€ä¸ªé€’å¢å­åºåˆ—ä¸€å®šæ˜¯ A å’Œ B çš„ä¸€ä¸ªå…¬å…±å­åºåˆ—ã€‚

ä¸è¿‡ï¼Œè¿™æ˜¯æœ‰**é™åˆ¶**çš„ï¼Œå³ï¼š

>  B çš„å…ƒç´ å¿…é¡»æ˜¯ A çš„å­é›†ï¼Œå³ B ä¸­ä¸èƒ½å­˜åœ¨ A ä¸å­˜åœ¨çš„å…ƒç´ ï¼Œå¦åˆ™ B æ— æ³•æ ¹æ® A çš„ç¦»æ•£å…³ç³»å®Œæˆç¦»æ•£ã€‚

ä¸è¿‡é¢˜ç›®ç»™äº†ä¸€ä¸ªå¾ˆé‡è¦çš„æ€§è´¨ï¼šA å’Œ B éƒ½æ˜¯ 1~n çš„å…¨æ’åˆ—ã€‚

é‚£ä¹ˆï¼Œè¿™ç§æ–¹æ³•æ˜¯å¦èƒ½å¤„ç† A å’Œ B åŒ…å«é‡å¤å…ƒç´ çš„æƒ…å†µå‘¢ï¼Ÿ

åº”è¯¥æ˜¯å¯ä»¥çš„ï¼Œæˆ‘ä»¬æŠŠé€’å¢æ”¹ä¸ºéé€’å‡å°±è¡Œäº†ã€‚

å¥½ï¼Œç°åœ¨åšæ³•å¾ˆæ˜ç¡®äº†ï¼š

1. ç¦»æ•£åŒ–ï¼ˆå»ºç«‹æ˜ å°„ï¼‰
2. LIS äºŒåˆ†æ¨¡æ¿

``` c++
#include <iostream>
#include <cstring>
#include <algorithm>

using namespace std;

const int N = 1e5 + 10;

int a[N], n;
unordered_map<int,int> mp;
int q[N];

int LIS(int w[]) // O(NlogN) LIS æ¨¡æ¿
{
    int len = 0;
    for(int i = 1; i <= n; i ++ )
    {
        int l = 0, r = len, cur = w[i];
        while(l < r)
        {
            int mid = l + r + 1 >> 1;
            if(cur > q[mid]) l = mid;
            else r = mid - 1;
        }
        len = max(len, r + 1);
        q[r + 1] = w[i];
    }
    return len;
}

int main()
{
    cin >> n;
    for(int i = 1; i <= n; i ++ )   
    {
        cin >> a[i];
        mp[a[i]] = i; // å»ºç«‹æ˜ å°„å…³ç³»
    }
    for(int i = 1; i <= n; i ++ )   
    {
        cin >> a[i]; // aæ•°ç»„ç”¨ä¸åˆ°äº†ï¼Œé‡å¤åˆ©ç”¨ ^^
        a[i] = mp[a[i]];    // æ˜ å°„ï¼ˆç¦»æ•£ï¼‰
    }
    cout << LIS(a) << endl;        
    return 0;
}
```



#### P2758

``` c++
#include <iostream>
#include <cstring>
#include <algorithm>

using namespace std;

const int N = 2010;
int f[N][N]; 
// f[i][j] è¡¨ç¤ºæŠŠaå‰iä¸ªå­—ç¬¦
// bå‰jä¸ªå­—ç¬¦ä¿®æ”¹ä¸ºç›¸åŒå­—ç¬¦ä¸²çš„æœ€å°‘ä¿®æ”¹æ¬¡æ•°

void out(int n, int m)
{
    for(int i = 0; i <= n; i ++ )
    {
        for(int j = 0; j <= m; j ++ )
            cout << f[i][j] << ' ';
        cout << endl;
    }
}

int main()
{
    string a, b;    cin >> a >> b;
    // è®©ä¸‹æ ‡ä»1å¼€å§‹ï¼Œæ–¹ä¾¿å¤„ç†
    a = "#" + a;
    b = "#" + b;    
    int n = a.size(), m = b.size();
    int k = max(n, m);
    for(int i = 0; i <= k; i ++ )   f[i][0] = f[0][i] = i;
    for(int i = 1; i <= n; i ++ )
    {
        for(int j = 1; j <= m; j ++ )
        {
            // ä¸éœ€è¦ä¿®æ”¹
            if(a[i] == b[j])    f[i][j] = f[i - 1][j - 1];
            else // f[i] != f[j]
            {
                // insert
                // f[i][j] = min({f[i][j], f[i - 1][j], f[i][j - 1]});
                
                // del a[i] / b[j]
                // f[i][j] = min({f[i][j], f[i - 1][j], f[i][j - 1]});
                
                // change
                // f[i][j] = min(f[i][j], f[i - 1][j - 1] + 1);
                
                // above all
                f[i][j] = min({f[i - 1][j], f[i][j - 1], f[i - 1][j - 1]}) + 1;
            }
        }
    }
    cout << f[n][m] << endl;
    return 0;
}
```



#### [LCIS](https://www.acwing.com/problem/content/274/)

æœ€é•¿å…¬å…±ä¸Šå‡å­åºåˆ—æ¨¡æ¿ï¼Œ[reference here](https://www.acwing.com/solution/content/4955/)

ç‰¢è®°ï¼ŒLCIS å°±æ˜¯ LIS å’Œ LCS çš„ç»“åˆç‰ˆï¼Œå› æ­¤çŠ¶æ€æ–¹ç¨‹çš„å®šä¹‰ä¸ºï¼š

```
f[i][j]:ä»¥b[j]ç»“å°¾çš„æœ€é•¿å…¬å…±ä¸Šå‡å­åºåˆ—
```

çŠ¶æ€çš„åˆ’åˆ†ï¼š

1. ä¸é€‰ `a[i]`ï¼Œ``f[i][j]=f[i-1][j]``
2. é€‰æ‹© `a[i]`ï¼Œå‰ææ˜¯ `a[i]==b[j]`ï¼Œç»§ç»­åˆ’åˆ†å­é›†åˆï¼Œä¾æ®å­åºåˆ—çš„å€’æ•°ç¬¬äºŒä¸ªå…ƒç´ åœ¨ `b[]` ä¸­æ˜¯å“ªä¸€ä¸ªæ•°
   * å­åºåˆ—ä¸­åªåŒ…å« `b[j]` ä¸€ä¸ªæ•°ï¼Œé•¿åº¦ä¸º 1
   * å­åºåˆ—çš„å€’æ•°ç¬¬äºŒä¸ªæ•°æ˜¯ `b[1]` çš„é›†åˆï¼Œæœ€å¤§é•¿åº¦ä¸º `f[1][j-1]+1`
   * â€¦â€¦
   * å­åºåˆ—çš„å€’æ•°ç¬¬äºŒä¸ªæ•°æ˜¯ `b[j-1]` çš„é›†åˆï¼Œæœ€å¤§é•¿åº¦ä¸º `f[i-1][j-1]+1`

æ³¨æ„ï¼Œ``f[i-1][x]`` å¹¶ä¸ä¸€å®šå°±æ¯” `f[i-1][y]` å°ï¼ˆ`x<y`ï¼‰ã€‚

æ‰€ä»¥æŒ‰ç…§ä¸Šè¿°æ€è·¯å®ç°ï¼Œéœ€è¦ $O(N^3)$

``` c++
for(int i = 1; i <= n; i ++ )
{
    for(int j = 1; j <= n; j ++ )
    {
        // ä¸é€‰ a[i]
        f[i][j] = f[i - 1][j];
        // é€‰ a[i]ï¼Œå‰ææ˜¯a[i]==b[j]
        if(a[i] == b[j])
        {
            // å› ä¸º a[i]==b[j]ï¼Œæ‰€ä»¥ f[i][j] é•¿åº¦è‡³å°‘ä¸º 1
            int maxn = 1;
            for(int k = 1; k < j; k ++ )
                if(a[i] > b[j]) // æ»¡è¶³ä¸Šå‡
                    maxn = max(maxn, f[i - 1][k] + 1);
            f[i][j] = max(f[i][j], maxn);
        }
    }
}
```

ç„¶åæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œæ¯æ¬¡æšä¸¾ `j` æ—¶ï¼Œæ±‚ `f[i-1][k]+1` çš„æœ€å¤§å€¼è¿™ä¸€æ­¥æœ‰å¾ˆå¤šçš„å†—ä½™è®¡ç®—ï¼Œå› ä¸º `i` æ˜¯åœ¨å¤–å±‚æšä¸¾çš„ï¼Œå½“æšä¸¾ `j` æ—¶ï¼Œè¿™ä¸ªæœ€å¤§å€¼æ˜¯ä¸å˜çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æŠŠå®ƒæå‡ºæ¥ã€‚

``` c++
#include <iostream>
#include <cstring>
#include <algorithm>

using namespace std;

const int N = 3010;

int n;
int a[N], b[N];
int f[N][N];
// f[i][j] è¡¨ç¤ºä»¥ b[j]ç»“å°¾çš„æœ€é•¿å…¬å…±ä¸Šå‡å­åºåˆ—

int main()
{
    cin >> n;
    for(int i = 1; i <= n; i ++ )   cin >> a[i];
    for(int i = 1; i <= n; i ++ )   cin >> b[i];
    
    for(int i = 1; i <= n; i ++ )
    {
        int maxn = 1;   // æåˆ°å¤–è¾¹ï¼Œè‡³å°‘ä¸º1 
        for(int j = 1; j <= n; j ++ )
        {
            // 1. ä¸é€‰ a[i]
            f[i][j] = f[i - 1][j];
            // 2. é€‰ a[i]ï¼Œåˆ™ a[i] å¿…é¡»è¦ç­‰äº b[j]
            /* åŸæœ¬æ˜¯è¿™æ ·çš„ï¼š
            for (int k = 1; k < j; k ++ )
                if (a[i] > b[k])
                    maxv = max(maxv, f[i - 1][k] + 1);
            f[i][j] = max(f[i][j], maxv);
            */
            if(a[i] == b[j]) // ç›´æ¥ä½¿ç”¨ maxnï¼Œä¸éœ€è¦åœ¨é¢å¤–çš„ç”¨ä¸€å±‚å¾ªç¯æ¥æ±‚äº†    
                f[i][j] = max(f[i][j], maxn); 
            // ç»´æŠ¤ maxn
            if(a[i] > b[j]) 
                maxn = max(maxn, f[i - 1][j] + 1);
        }
    }
    int res = 0;
    for(int i = 1; i <= n; i ++ ) res = max(res, f[n][i]);  
    cout << res << endl;
    return 0;
}
```

#### P1020ï¼ˆTODO â€“ LDSï¼‰

ç¬¬ä¸€é—®ï¼šæœ€é•¿ï¼ˆä¸ä¸¥æ ¼ï¼‰é€’å‡å­åºåˆ—çš„äºŒåˆ†ç‰ˆæœ¬ã€‚å¦‚æœä½ ä¸ä¼šå†™ LDS çš„è¯ï¼Œå°±ç”¨ vector ç¿»è½¬æ•°ç»„ï¼Œè½¬æ¢ä¸º LISï¼Œä½†æ˜¯è¦æ³¨æ„æ•°ç»„ååˆ«æ··ç”¨äº†ã€‚

ç¬¬äºŒé—®ï¼šç«è½¦è¿›ç«™é—®é¢˜ï¼ˆè´ªå¿ƒï¼‰ã€‚

[LIS æ¨¡æ¿é¢˜](https://www.acwing.com/problem/content/897/)

``` c++
#include <iostream>
#include <cstring>
#include <algorithm>
#include <vector>
#include <stack>

using namespace std;

const int N = 1e5 + 10;

int n, f[N], w[N];
int q[N];

void init()
{
    int x;
    while(scanf("%d", &x) != EOF) w[ ++ n] = x; 
}

void LDS()
{
    vector<int> a(w + 1, w + 1 + n);
    reverse(a.begin(), a.end());
    int len = 0; 
    for(int i = 0; i < n; i ++ )   
    {
        int l = 0, r = len;
        while(l < r)
        {
            int mid = 1 + l + r >> 1;
            if(a[i] >= q[mid])   l = mid;    
            // LISå’ŒLDSçš„ä¸åŒä»…ä»…åœ¨äºè¿™é‡Œæ¢ä¸€ä¸‹å¤§äºå°äºå·
            else r = mid - 1;
        }
        len = max(len, r + 1);
        q[r + 1] = a[i];
    }
    cout << len << endl;
}

// ç¥å¥‡çš„å‡½æ•°å
void train_in_stack()
{
    vector<int> stk; 
    for(int i = 1; i <= n; i ++ )
    {
        bool flag = false;
        for(auto &x : stk)
        {
            if(x >= w[i])
            {
                flag = true;
                x = w[i];
                break;  // æ“¦ï¼Œå¿˜äº†åŠ  breakï¼Œæˆ‘æ˜¯ sb
            }
        }
        if(!flag)   stk.push_back(w[i]);
    }
    cout << stk.size() << endl;
}

void solve()
{
    init();
    LDS();
    train_in_stack();
}

int main()
{
    solve();
    return 0;
}
/*
test case:
[input]
90 103 99 83 102 70 86 70 99 71
[output]
5 3
*/
```

#### P1077

æˆ‘å‚»é€¼äº†ï¼Œä¸€å¼€å§‹é¢˜éƒ½æ²¡è¯»æ˜ç™½ï¼Œå…¶å®å¾ˆç®€å•ï¼Œç»™å®šæˆ‘ä»¬ä¸€ä¸ªç‰©å“ä¸ªæ•°nå’Œä½“ç§¯mä»¥åŠæ¯ä¸ªç‰©å“çš„ä¸ªæ•°ã€‚é—®ï¼Œå¦‚ä½•ç»„åˆnä¸ªç‰©å“èƒ½ä½¿å¾—ä»–ä»¬çš„ä½“ç§¯ä¹‹å’Œä¸ºmï¼Œè§„å®šä»»æ„ç‰©å“çš„ä½“ç§¯ä¸º1ã€‚

> æ³¨ï¼šè¿™é‡Œçš„ç»„åˆæŒ‡çš„æ˜¯ä¸ªæ•°çš„ç»„åˆã€‚
>
> ä¾‹å¦‚æœ‰ä¸¤ä¸ªç‰©å“aå’Œbã€‚
>
> åˆ™ï¼Œaabaaå’Œaaaabçš„ç»„åˆç®—ä½œåŒä¸€ä¸ªã€‚
>
> æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦è€ƒè™‘aå’Œbçš„ä¸ªæ•°å°±è¡Œäº†ã€‚

æ‰€ä»¥è¯´ï¼Œé¢˜ç›®è™½ç„¶å¾ˆå”¬äººçš„è¯´ï¼š` æ‘†èŠ±æ—¶åŒä¸€ç§èŠ±æ”¾åœ¨ä¸€èµ·ï¼Œä¸”ä¸åŒç§ç±»çš„èŠ±éœ€æŒ‰æ ‡å·çš„ä»å°åˆ°å¤§çš„"é¡ºåº"ä¾æ¬¡æ‘†åˆ—ã€‚`

ä½†æ˜¯æˆ‘ä»¬ä¸ç”¨ç®¡ï¼Œæˆ‘ä»¬åªéœ€è¦è€ƒè™‘â€œä¸ªæ•°â€å°±è¡Œäº†ã€‚

å¯¹äºæ ·ä¾‹ï¼Œè§£é‡Šä¸€ä¸‹ï¼šæœ‰ä¸¤ä¸ªç‰©å“ï¼Œå‡è®¾ä¸ºaå’Œbï¼Œaæœ‰3ä¸ªï¼Œbæœ‰2ä¸¤ä¸ªï¼Œä½“ç§¯ä¸º4ï¼Œå³ï¼Œä»aå’Œbä¸­é€‰å‡º4ä¸ªç‰©å“çš„æ–¹æ¡ˆæœ‰å¤šå°‘ç§å‘¢ï¼Ÿ

``` c++
a=2,b=2;
a=3,b=1;
ä¸¤ç§ã€‚
```

ä»é¢˜ç›®èŒƒå›´é™¤æ³•ï¼Œå‘ç° n=100ï¼Œä½†æ˜¯ä¸ç®¡ï¼Œæˆ‘ç›´æ¥ä¸€å‘çˆ†æœï¼Œå¯¹äºè“æ¡¥æ¯è¿™ç§æŒ‰æµ‹è¯•ç‚¹å¾—åˆ†çš„ï¼Œå¯ä»¥éª—åˆ†ã€‚éª—ä¸äº†åˆ†ï¼Œè¿˜å¯ä»¥ç”¨æ¥å¯¹æ‹ã€‚è€Œä¸”çˆ†æœæ€è·¯ç®€å•ï¼Œä»£ç å°‘ï¼Œä¸å ç”¨å¤šå°‘æ—¶é—´ï¼Œä»£ç ï¼šé€šè¿‡ 30%

``` c++
#include <iostream>
#include <cstring>
#include <algorithm>
#include <vector>

using namespace std;

const int N = 110, mod = 1e6 + 7;

int n, m;
int a[N];
int res;

void dfs(int u, int cnt, vector<int> path)
{
    if(cnt == m)
    {
        res ++ ;
        // cout << "path: ";
        // for(auto &x : path) cout << x << ' ';   cout << endl;
        return ;
    }
    if(u == n)  return ;
    // å¯ä»¥ä¸é€‰
    dfs(u + 1, cnt, path);
    // é€‰
    for(int i = 1; i <= a[u] && cnt + i <= m; i ++ ) 
    {
        path.push_back(i);
        dfs(u + 1, cnt + i, path);
        path.pop_back();
    }
}

void solve()
{
    vector<int> path;
    cin >> n >> m;
    for(int i = 0; i < n; i ++ )   cin >> a[i];
    dfs(0, 0, path);
    cout << res << endl;
}

int main()
{
    solve();
    return 0;
}
```

é€šå¸¸ï¼Œéƒ½æ˜¯é€šè¿‡è®°å¿†åŒ–æ¥ä¼˜åŒ–çˆ†æœçš„ï¼Œè¿™é‡Œçˆ†æœè‚¯å®šå­˜åœ¨ç›¸å½“å¤šçš„é‡å¤æœç´¢ï¼Œä¾‹å¦‚æœ‰ä¸‰ä¸ªç‰©å“ï¼šaï¼Œbï¼Œc

å½“a=2ï¼Œb=3å’Œa=3ï¼Œb=2æ—¶ï¼Œå»æœç´¢cå°±å‡ºç°é‡å¤æœç´¢äº†ã€‚

æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡ç©ºé—´æ¢æ—¶é—´ï¼Œæ¥è®°å¿†åŒ–å·²ç»æœç´¢çš„çŠ¶æ€ï¼š

``` c++
#include <iostream>
#include <cstring>
#include <algorithm>
#include <vector>

using namespace std;

const int N = 110, mod = 1e6 + 7;

int n, m;
int a[N];
int f[N][N];
// f[u][cnt]è¡¨ç¤ºä»ç¬¬u(åŒ…æ‹¬u)ä¸ªç‰©å“å¼€å§‹ï¼Œå·²ç»æœ‰äº†cntä¸ªç‰©å“çš„æ–¹æ¡ˆæ•°
int res;

int dfs(int u, int cnt, vector<int> path)
{
    if(f[u][cnt] != -1) return f[u][cnt];
    if(cnt == m)    return 1;
    if(u == n)  return 0;
    
    int res = 0;
    // å¯ä»¥ä¸é€‰
    res = dfs(u + 1, cnt, path) % mod;
    // é€‰
    for(int i = 1; i <= a[u] && cnt + i <= m; i ++ ) 
    {
        path.push_back(i);
        res = ((long long)dfs(u + 1, cnt + i, path) + res) % mod;
        path.pop_back();
    }
    return f[u][cnt] = res;
}

void solve()
{
    // åˆå§‹åŒ–ä¸ºè´Ÿæ•°æœ€é è°±ï¼Œå› ä¸ºå¯èƒ½å­˜åœ¨0æ–¹æ¡ˆæ•°
    memset(f, -1, sizeof f);
    // path ç”¨æ¥ debug ç”¨
    vector<int> path;
    cin >> n >> m;
    for(int i = 0; i < n; i ++ )   cin >> a[i];
    cout << dfs(0, 0, path) << endl;
}

int main()
{
    solve();
    return 0;
}
```

å“ï¼Œè¿™ä¸æ˜¯çº¿æ€§ dp ä¸“é¢˜å—ï¼Ÿä½ æœç´¢æ€ä¹ˆä¹±å…¥äº†æï¼Ÿ

hhï¼Œæ—¢ç„¶æ˜¯ dp ä¸“é¢˜ï¼Œé‚£æˆ‘ä»¬å°±æ¥ç ”ç©¶ä¸€ä¸‹ dp æ–¹æ³•ã€‚

å…¶å® dp æ€è·¯ä¹Ÿå¾ˆç®€å•ï¼Œæˆ‘ä»¬å‡è®¾æ¯æœµèŠ±çš„â€œä»·å€¼â€ç­‰äºå®ƒçš„â€œä½“ç§¯â€ï¼Œæ¯æœµèŠ±çš„ä½“ç§¯ä¸º1ï¼Œé—®ï¼Œæœ‰å¤šå°‘ç§é€‰æ‹©èŠ±çš„æ–¹æ¡ˆï¼Œä½¿å¾—ä»–ä»¬çš„ä»·å€¼ä¸º mï¼Œç”±äºä½“ç§¯å°±ç­‰äºä»·å€¼

å› æ­¤ ddddï¼Œä¸æƒ³å†è¯´äº†ï¼Œåˆ†ç»„èƒŒåŒ…é—®é¢˜ + æ±‚æ–¹æ¡ˆæ•°ï¼Œæ³¨æ„ä¸èƒ½è½¬åŒ–ä¸º 01 èƒŒåŒ…é—®é¢˜ï¼Œå¦åˆ™ä¼šæœ‰é‡å¤ï¼Œè¿˜è®°å¾—å—ï¼Ÿæˆ‘ä»¬åªè€ƒè™‘ä¸ªæ•°ã€‚å¦‚æœæ˜¯ 01 èƒŒåŒ…ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªèƒ½å°†æœ‰ä¸ªæ•°çš„èƒŒåŒ…è½¬æ¢ä¸º 01 èƒŒåŒ…ï¼Œæ­¤æ—¶ï¼Œ`2a + 1b + 1b` å’Œ `1a + 1a + 1b +1b` å°±ä¼šå˜æˆä¸¤ç§ä¸åŒçš„æ–¹æ¡ˆï¼Œä½†ä»–ä»¬å…¶å®éƒ½å±äº `a=2,b=2` è¿™ä¸€ç§æ–¹æ¡ˆã€‚

ç„¶åå°±æ˜¯æœ‰ä¸€ä¸ª **bug**ï¼Œåœ¨æšä¸¾ç¬¬ä¸‰ç»´å­ç‰©å“æ—¶ï¼Œk ä¸èƒ½å– 1ï¼Œä¸ºå•¥å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºåœ¨ç¨‹åºçš„æ‰§è¡Œé€»è¾‘ä¸­ï¼Œå¦‚æœ k=0ï¼Œæ­¤æ—¶ï¼š

```
int t = f[j - k] + k; // t == f[j]
```

ç”±äº `t==f[j]`ï¼Œä¼šæ‰§è¡Œï¼š

``` c++
else if(t == f[j])
{
    cnt[j] = ((long long)cnt[j] + cnt[j - k]) % mod;  
}
```

è¿™éƒ¨åˆ†è¯­å¥ï¼Œå¯¼è‡´æ–¹æ¡ˆæ•°å‡­ç©ºå¢åŠ äº†ä¸€å€ã€‚é‚£ä½ å¯èƒ½ä¼šé—®ï¼Œåœ¨æœç´¢ä¸­éƒ½å­˜åœ¨ä¸é€‰çš„æƒ…å†µï¼Œåˆ°ä½  dp å°±æ²¡å•¦ï¼Ÿå…¶å®ä¹Ÿä¸æ˜¯æ²¡äº†ï¼Œä½ ä¹Ÿå¯ä»¥æ¢ä¸€ç§å†™æ³•ï¼Œåœ¨ç¬¬3ä¸ªforä¸­æ·»åŠ ï¼š

```
if(k == 0) continue;
```

é‚£ä½ åˆèƒ½åˆé—®ï¼Œä¸é€‰æ—¶è‚¯å®šå­˜åœ¨æ–¹æ¡ˆï¼Œä½ è¿™é‡Œç›´æ¥continueæ„å‘³ç€ä¸é€‰å¯¹æ–¹æ¡ˆæ²¡æœ‰è´¡çŒ®äº†ï¼Ÿ

æˆ‘çŒœæµ‹ï¼Œå¯èƒ½æ˜¯å› ä¸ºæˆ‘ä»¬è®¾ç½® `cnt[0]=0` æœ‰å…³ç³»ï¼Œä¸é€‰çš„æƒ…å†µåŒ…å«åœ¨è¿™é‡Œé¢äº†ã€‚

``` c++
#include <iostream>
#include <cstring>
#include <algorithm>

using namespace std;

const int N = 110, mod = 1e6 + 7;

int n, m;
int a[N];
int f[N], cnt[N];

void init_back()
{
    cin >> n >> m;
    for(int i = 1; i <= n; i ++ )  cin >> a[i];
}

void solve()
{
    init_back();
    cnt[0] = 1; // ä»€ä¹ˆéƒ½ä¸é€‰ä¹Ÿæ˜¯ä¸€ç§æ–¹æ¡ˆ
    for(int i = 1; i <= n; i ++ )
    {
        for(int j = m; j >= 0; j -- )
        {
            // k != 0
            for(int k = 1; k <= a[i]; k ++ )
            {
                if(j - k < 0)    break;
                int t = f[j - k] + k;
                if(t > f[j])
                {
                    f[j] = t;
                    cnt[j] = cnt[j - k];
                }
                else if(t == f[j])
                {
                    cnt[j] = ((long long)cnt[j] + cnt[j - k]) % mod;  
                }
            }
        }
    }
    cout << cnt[m] << endl;
}

int main()
{
    solve();
    return 0;
}
```

#### P4933[TODO]

``` c++
// åœ°ä¸Šæ²¡æœ‰ç”µå¡”çš„æ–¹æ¡ˆè¢«è®¤ä¸ºæ˜¯ä¸ç¾è§‚çš„ã€‚
// åŒæ—¶ä¹Ÿè¦æ³¨æ„ï¼Œç­‰å·®æ•°åˆ—çš„å…¬å·®ä¹Ÿå¯ä»¥ä¸ºè´Ÿæ•°ã€‚
#include <iostream>
#include <cstring>
#include <algorithm>

using namespace std;

const int mod = 998244353, N = 1e3 + 10;

int n, a[N];
int f[N][N];
// f[i][j] è¡¨ç¤ºiå¼€å§‹,é•¿åº¦ä¸ºjçš„æ–¹æ¡ˆæ•°

int main()
{
    cin >> n;
    for(int i = 1; i <= n; i ++ )   cin >> w[i];
    for(int i = 1; i <= n; i ++ )
        f[i][1] = 1, f[i][2] = n - i + 1;
    
    
    
    return 0;
}
```

#### P1233

åº”è¯¥æ˜¯ä¸€é“æ¯”è¾ƒç»å…¸çš„ LIS å˜å½¢äº†ï¼Œå¦‚æœæˆ‘ä»¬æŒ‰ç…§ left é€’å‡æ’åºçš„è¯ï¼Œé‚£ä¹ˆæˆ‘ä¹ˆåªéœ€è¦è€ƒè™‘ right å°±è¡Œäº†ï¼Œå› ä¸ºæ­¤æ—¶ left æ˜¯ä¸€å®šç¬¦åˆè¦æ±‚çš„ã€‚

å—çš„ï¼Œæˆ‘æ˜¯é—¹æ½­ï¼Œ`[0,n)` å’Œ `[1,n]` å†™ä»£ç çš„æ—¶å€™æ€ä¹ˆèƒ½ææ··çš„å•Šï¼Ÿsbä¸ï¼Ÿï¼Ÿï¼Ÿï¼Ÿ

``` c++
#include <iostream>
#include <cstring>
#include <algorithm>

using namespace std;

const int N = 5010;
typedef pair<int, int> PII;

int n;
PII w[N];

void init()
{
    cin >> n;
    for(int i = 0; i < n; i ++ )    
        cin >> w[i].first >> w[i].second;
    sort(w, w + n, [&](const PII &l, const PII &r){
        if(l.first == r.first)    return l.second > r.second;
        return l.first > r.first;
    });
}

void solve()
{
    init();
    vector<int> q; // q ä¸€å®šæ˜¯é€’å¢çš„
    // é€†å¤©ï¼Œä¸€å¼€å§‹æˆ‘ä¸‹é¢çš„forå†™ä¸ºäº† i=0,i<=nï¼Œç«Ÿç„¶è¿‡äº† 90% çš„æ•°æ®ï¼Œç¦»å¤§è°±
    for(int i = 0; i < n; i ++ ) 
    {
        // æ‰¾åˆ°ç¬¬ä¸€ä¸ªå¤§äºç­‰äº w[i].second çš„
        auto t = lower_bound(q.begin(), q.end(), w[i].second);
        if(t == q.end())    q.push_back(w[i].second);
        else *t = w[i].second;
    }
    cout << q.size() << endl;
}

int main()
{
    solve();
    return 0;
}
```



#### P1091

å‘å·¦å‘å³åˆ†åˆ«æ±‚ LIS å³å¯.

ğŸ˜©å‘ç°æœ€è¿‘æˆ‘ä¹Ÿå–œæ¬¢ç”¨ `solve()` è¿™ç§ç”¨å‡½æ•°å°è£…çš„å½¢å¼ coding äº†ã€‚

``` c++
#include <iostream>
#include <cstring>
#include <algorithm>

using namespace std;

const int N = 110;

int n, w[N];
int l[N], r[N];
// l[i]è¡¨ç¤ºä»å·¦åˆ°å³ï¼Œä»¥iç»“å°¾çš„ LIS
// r[i]è¡¨ç¤ºä»å³åˆ°å·¦ï¼Œä»¥iç»“å°¾çš„ LIS

void init()
{
    cin >> n;
    for(int i = 1; i <= n; i ++ )   cin >> w[i];
}

void LIS_left(int f[])
{
    for(int i = 1; i <= n; i ++ )
    {
        f[i] = 1;
        for(int j = 1; j < i; j ++ )
            if(w[j] < w[i]) 
                f[i] = max(f[i], f[j] + 1);
    }
}

void LIS_right(int f[])
{
    for(int i = n; i >= 1; i -- )
    {
        f[i] = 1;
        for(int j = n; j > i; j -- )
            if(w[j] < w[i])
                f[i] = max(f[i], f[j] + 1);
    }
}

void solve()
{
    init();
    LIS_left(l);
    LIS_right(r);
    int res = 0;
    for(int i = 1; i <= n; i ++ )
        res = max(res, l[i] + r[i] - 1);
    cout << n - res << endl;
}

int main()
{
    solve();
    return 0;
}
```



### çŠ¶æ€å‹ç¼©åŠ¨æ€è§„åˆ’

#### [æœ€çŸ­å“ˆå¯†é¡¿è·¯å¾„](https://www.acwing.com/activity/content/problem/content/1011/)

æˆ‘ä¸å…è®¸æœ‰äººä¸ä¼šæœ€çŸ­å“ˆå¯†é¡¿è·¯å¾„ğŸ˜­

``` c++
#include <iostream>
#include <cstring>
#include <algorithm>

using namespace std;

const int N = 20, M = 1 << N;

int n;
int w[N][N];
int f[M][N];

int main()
{
    cin >> n;
    for(int i = 0; i < n; i ++ )    
        for(int j = 0; j < n; j ++ )
            cin >> w[i][j];
    
    memset(f, 0x3f, sizeof f);
    f[1 << 0][0] = 0;
    
    for(int i = 1; i < (1 << n); i ++ )
        for(int j = 0; j < n; j ++ )
            if(i >> j & 1)
                for(int k = 0; k < n; k ++ )
                    if(i >> k & 1)
                        f[i][j] = min(f[i][j], f[i - (1 << j)][k] + w[k][j]);
                        
    cout << f[(1 << n) - 1][n - 1] << endl;
    return 0;
}
```



#### [è’™å¾·é‡Œå®‰çš„æ¢¦æƒ³](https://www.acwing.com/activity/content/problem/content/1010/)

> [ref here](https://lishizheng.blog.csdn.net/article/details/112706309)



#### P1441

> [reference here !!](https://www.luogu.com.cn/blog/hsfzLZH1/solution-p1441)

å…¸å‹çš„ `dfs+dp` ï¼Œdfsæšä¸¾æ–¹æ¡ˆï¼Œdp æ±‚æ–¹æ¡ˆæ•°ã€‚

``` c++
#include <iostream>
#include <cstring>
#include <algorithm>

using namespace std;

const int N = 23, M = N * 100;

int n, m, w[N];
bool st[N]; // st[i]=trueï¼Œç ç iè¢«åˆ é™¤
bool f[M];
int res;

void init()
{
    cin >> n >> m;
    for(int i = 0; i < n; i ++ )   cin >> w[i];
}

void dp()
{
    memset(f, 0, sizeof f);
    f[0] = true;   // åˆå§‹åŒ–
    int cur = 0, tot = 0;
    for(int i = 0; i < n; i ++ )
    {
        if(st[i])   continue;
        // å°ä¼˜åŒ–ï¼ŒåŠ¨æ€ç»´æŠ¤ totï¼Œå‡å°‘ç¬¬äºŒä½çš„å¾ªç¯æ¬¡æ•°
        tot += w[i];
        for(int j = tot; j >= w[i]; j -- )
        {
            if(f[j - w[i]] && !f[j])
            {
                f[j] = true;
                cur ++ ;
            }
        }
    }
    // cout << "res: " << res << endl;
    res = max(res, cur);
}

// å› ä¸ºè¢«åˆ é™¤çš„ç ç ä¸ªæ•°å°äºéœ€è¦ä¿ç•™çš„ç ç ä¸ªæ•°
// å› æ­¤æˆ‘ä»¬ä»¥åˆ é™¤çš„ç ç ä¸ªæ•°ä½œä¸ºæ¡ä»¶
void dfs(int u, int cnt)
{
    // æ‰¾å‡ºæ¯ä¸€ç§æ–¹æ¡ˆ
    if(cnt == m)    return dp();
    if(u == n)  return ;
    // ä¸åˆ é™¤
    dfs(u + 1, cnt);
    // åˆ é™¤
    st[u] = true;
    dfs(u + 1, cnt + 1);
    st[u] = false;
}

void solve()
{
    init();
    dfs(0, 0);
    cout << res << endl;
}

int main()
{
    solve();
    return 0;
}
```

dp å‡½æ•°è¿˜å¯ä»¥å†™ä¸ºä¸‹é¢çš„å½¢å¼ï¼Œå¹¶ä¸”æˆ‘å‘ç°ï¼Œè½è°·ä¸Šçš„é¢˜è§£éƒ½æ˜¯è¿™ä¹ˆå†™çš„ï¼Œè¿™ä¹ˆå†™æœ‰ä¸€ä¸ªå¥½å¤„å°±æ˜¯ä¸ä¼šå‡ºç° `j-w[i]`ï¼Œä¹Ÿå°±ä¸ä¼šå‡ºç° `j-w[i]` å°äº 0 çš„æƒ…å†µã€‚

ä½†æˆ‘è®¤ä¸ºè¿™ä¹Ÿä¸æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„è§£é‡Šå§ï¼Ÿæ¯•ç«Ÿåœ¨ `for` é‡Œé¢åŠ ä¸Š `j>=w[i]` ä¹Ÿæ˜¯ä¸€ä»¶å¾ˆç®€å•çš„äº‹æƒ…å•Šï¼Ÿä¸å¤ªç†è§£ã€‚æˆ‘ä¹Ÿä¸å–œæ¬¢ä¸‹é¢çš„å†™æ³•ï¼Œæ¯•ç«Ÿä¹ æƒ¯äº†ä¸Šé¢çš„å†™æ³•ã€‚

``` c++
void dp_way2()
{
    memset(f, 0, sizeof f);
    f[0] = true;   // åˆå§‹åŒ–
    int cur = 0, tot = 0;
    for(int i = 0; i < n; i ++ )
    {
        if(st[i])   continue;
        for(int j = tot; j >= w[i]; j -- )
        {
            if(f[j] && !f[j + w[i]])
            {
                f[j + w[i]] = true;
                cur ++ ;
            }
        }
        tot += w[i];
    }
    // cout << "res: " << res << endl;
    res = max(res, cur);
}
```

#### P1896

çŸ©é˜µçŠ¶æ€å‹ç¼© DP + äºŒè¿›åˆ¶ä¼˜åŒ–

å…³äºæšä¸¾çš„é¡ºåºï¼Œæˆ‘ä»¬è¦ç•™æ„ä¸€ä¸‹ï¼š

1. å›½ç‹ä¸ªæ•°çš„æšä¸¾è‚¯å®šè¦æ”¾åœ¨çŠ¶æ€çš„åé¢ï¼Œå› ä¸ºå›½ç‹çš„ä¸ªæ•°å–å†³äºçŠ¶æ€ã€‚
2. è¡Œçš„æšä¸¾è¦æ”¾åœ¨çŠ¶æ€çš„å‰é¢ï¼Œè¿™ä¸€ç‚¹å¾ˆå…³é”®ã€‚å¦‚æœæˆ‘ä»¬å…ˆæšä¸¾çŠ¶æ€ï¼Œé‚£ä¹ˆæœ‰äº›çŠ¶æ€å¯èƒ½æœªè¢«è®¡ç®—å°±è¢«æˆ‘ä»¬è½¬ç§»äº†ï¼Œè¿™ä¸å¤ªåˆé€‚ã€‚

ç»¼ä¸Šï¼ŒæŒ‰ç…§è¡Œ-çŠ¶æ€-è½¬ç§»çŠ¶æ€-å›½ç‹ä¸ªæ•°çš„é¡ºåºæ¥æšä¸¾ã€‚

> [reference here!!!](https://www.luogu.com.cn/blog/xcg--123/ti-xie-p1896-scoi2005-hu-fou-qin-fan)

``` C++
#include <iostream>
#include <cstring>
#include <algorithm>

using namespace std;

const int N = 11, M = N * N, K = 1 << N;
typedef long long ll;

int n, m;
ll f[N][M][K];
// f[i][j][s] è¡¨ç¤ºæšä¸¾åˆ°äº†ç¬¬iè¡Œï¼Œå·²ç»é€‰äº†jä¸ªè¿‡å¾€
// ç¬¬iè¡ŒçŠ¶æ€ä¸ºsçš„æ–¹æ¡ˆæ•°
ll cnt[K];  // cnt[i]è¡¨ç¤ºiäºŒè¿›åˆ¶ä¸‹æœ‰å¤šå°‘ä¸ª1
int valid[K], idx;

void init()
{
    cin >> n >> m;
    // é¢„å¤„ç†iåœ¨äºŒè¿›åˆ¶ä¸‹æœ‰å¤šå°‘ä¸ª1
    // ä»¥åŠæ‘†æ”¾æ˜¯å¦åˆæ³•
    for(int s = 0; s < (1 << n); s ++ )
    {
        int sum = 0, st = s;
        while(st)
        {
            if(st & 1) sum ++ ;
            st >>= 1;
        }
        cnt[s] = sum;
        // æ¯ä¸ªå›½ç‹çš„å·¦å³ä¸¤ä¾§ä¸èƒ½å†æœ‰å›½ç‹äº†
        int t = (s << 1) | (s >> 1);
        if((t & s) == 0)    valid[idx ++ ] = s;    
    }
}

void doDP()
{
    f[0][0][0] = 1;
    for(int i = 1; i <= n; i ++ )
    {
        for(int l = 0; l < idx; l ++ )
        {
            int s1 = valid[l];
            for(int r = 0; r < idx; r ++ )
            {
                int s2 = valid[r];
                int t = (s2 << 1) | (s2 >> 1) | s2;
                if(t & s1) continue; // ä¸¤è¡Œä¹‹é—´ä¸åˆæ³•
                for(int j = 0; j <= m; j ++ )
                {
                    if(j - cnt[s1] >= 0)
                        f[i][j][s1] += f[i - 1][j - cnt[s1]][s2];
                }
            }
        }
    }
}

ll get_res()
{
    ll res = 0;
    for(int i = 0; i < idx; i ++ )
        res += f[n][m][valid[i]];
    return res;
}

void solve()
{
    init();
    doDP();
    cout << get_res() << endl;
}

int main()
{
    solve();
    return 0;
}
```

